var Pandyle,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();(function(t){function e(e){return t._methods[e]}function n(t,e){var n=new RegExp("^\\w+"+e+"$");return n.test(t)}function r(e,r){t.$.isFunction(r)?n(e,"Filter")?t._filters[e]=r:n(e,"Converter")?t._converters[e]=r:t._methods[e]=r:t._variables[e]=r}function i(e){for(var n in e)t._config[n]=e[n]}function a(t){return t.data("pandyle")||t.data("pandyle",{}),t.data("pandyle")}t._variables={},t._methods={},t._filters={},t._converters={},t._components={},t._config={},t.getMethod=e,t.hasSuffix=n,t.register=r,t.config=i,t.getDomData=a})(Pandyle||(Pandyle={})),function(t){function e(e){return void 0!==t._components[e]}function n(e){t._components[e.name]=e}function r(e){return t._components[e]}function i(i,o){function c(e,r,i,o,c){var p=new a(r,e);e=e.replace(/<\s*style\s*>((?:.|\r|\n)*?)<\/style\s*>/g,function(e,n){return t.$("head").append(e),""}),e=e.replace(/<\s*link.*href\s*\=\s*["'](.*)["'].*>/g,function(e,n){return 0===t.$('head link[href="'+n+'"]').length&&t.$("head").append(e),""}),e=e.replace(/<\s*script.*src\s*\=\s*["'](.*)["'].*><\/script\s*>/g,function(e,n){return 0===t.$('head script[src="'+n+'"]').length&&t.$("head").append(e),""}),e=e.replace(/<\s*script\s*>((?:.|\r|\n)*?)<\/script\s*>/g,function(t,e){return new Function(e).call(p),""}),p.html=e,n(p),s.html(e);var u=s.children();u.each(function(e,n){t.getDomData(t.$(n)).context=i}),t.getDomData(s).children=u,p.onLoad&&p.onLoad(i,o,c)}var s=t.$(i),p=s.attr("p-com"),u=t.getDomData(s);if(p!==u.componentName){u.componentName=p,s.children().remove();var l=u.context;if(p=t.$.trim(p),e(p)){var h=r(p);s.html(h.html);var d=s.children();d.each(function(e,n){var r=t.getDomData(t.$(n));r.context=l}),u.children=d,h.onLoad&&h.onLoad(l,i,o)}else{var f="";if(/^@.*/.test(p))f=p.replace(/^@/,"");else{var v=p.split("."),y=t._config.comPath&&t._config.comPath.Default||"./components/{name}.html";v.length>1?(y=t._config.comPath[v[0]],f=y.replace(/{.*}/g,v[1])):f=y.replace(/{.*}/g,p)}t.$.ajax({url:f,async:!1,success:function(t){c(t,p,l,i,o)}})}}}var a=function(){function e(t,e){this.name=t,this.html=e}return e.prototype.setPrivateData=function(e,n){t.getDomData(e).alias.private={data:n,property:"@private"}},e.prototype.afterRender=function(e,n){t.getDomData(e).afterRender=n},e.prototype.getPrivateData=function(e){return t.getDomData(e).alias.private.data},e}();t.Component=a,t.hasComponent=e,t.addComponent=n,t.getComponent=r,t.loadComponent=i}(Pandyle||(Pandyle={})),function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports&&"object"==typeof module?exports=module.exports=e(require("jquery")):e(t.jQuery)}(this,function(t){return Pandyle.$=t,t.fn.vm=function(t,e){void 0===e&&(e=!0);var n=this;if(n.data("vm"))return n.data("vm");var r=new Pandyle.VM(n,t,e);return n.data("vm",r),r},t.fn.inputs=function(){var t=this;if(t.data("inputs"))return t.data("inputs");var e=new Pandyle.Inputs(t);return t.data("inputs",e),e},Pandyle}),function(t){var e=function(){function e(t){this._data={},this._root=t,this.initData(),this.bindChange()}return e.prototype.data=function(){return t.$.extend(!0,{},this._data)},e.prototype.set=function(t){for(var e in t){this.setData(e,t[e]);var n=this._root.find('[name="'+e+'"]');this.updateDom(n,t[e]),n.trigger("modelChange",t[e])}},e.prototype.refresh=function(){this._data={},this.initData()},e.prototype.initData=function(){var e=this;this._root.find("input,textarea,select").each(function(n,r){var i=t.$(r),a=i.prop("tagName"),o=i.prop("name");if(o){var c=i.val()||"";switch(e.initName(o),a){case"INPUT":e.initData_input(i,o,c);break;case"TEXTAREA":e.initData_normal(i,o,c);break;case"SELECT":e.initData_select(i,o,c)}}})},e.prototype.initData_input=function(t,e,n){var r=t.prop("type");switch(r){case"radio":this.initData_radio(t,e,n);break;case"checkbox":this.initData_check(t,e,n);break;default:this.initData_normal(t,e,n)}},e.prototype.initData_radio=function(e,n,r){t.$.isEmptyObject(this.getDataByName(n))&&this.setData(n,""),e.prop("checked")&&this.setData(n,r)},e.prototype.initData_check=function(e,n,r){1===t.$('input[name="'+n+'"]').length?this.setData(n,!!e.prop("checked")):(t.$.isEmptyObject(this.getDataByName(n))&&this.setData(n,[]),e.prop("checked")&&this.getDataByName(n).push(r))},e.prototype.initData_normal=function(t,e,n){this.setData(e,n)},e.prototype.initData_select=function(t,e,n){this.setData(e,n)},e.prototype.bindChange=function(){var e=this;this._root.on("change viewChange keyup","input,textarea,select",function(n){var r=t.$(n.currentTarget),i=r.prop("tagName"),a=r.prop("name"),o=r.val();switch(i){case"INPUT":e.onChange_input(r,a,o);break;case"TEXTAREA":e.onChange_normal(r,a,o);break;case"SELECT":e.onChange_select(r,a,o)}e.callBack&&e.callBack(a,e.getDataByName(a))})},e.prototype.onChange_normal=function(t,e,n){this.setData(e,n)},e.prototype.onChange_input=function(t,e,n){switch(t.prop("type")){case"radio":this.onChange_radio(t,e,n);break;case"checkbox":this.onChange_check(t,e,n);break;default:this.onChange_normal(t,e,n)}},e.prototype.onChange_radio=function(t,e,n){t.prop("checked")&&this.setData(e,n)},e.prototype.onChange_check=function(e,n,r){var i=this.getDataByName(n);if("boolean"===t.$.type(i))this.setData(n,!i);else if(e.prop("checked"))i.push(r);else{var a=i.indexOf(r);i.splice(a,1)}},e.prototype.onChange_select=function(t,e,n){this.setData(e,n)},e.prototype.initName=function(t){t.split(".").reduce(function(t,e){return t[e]?t[e]:(t[e]={},t[e])},this._data)},e.prototype.getDataByName=function(t){return t.split(".").reduce(function(t,e){return t[e]},this._data)},e.prototype.setData=function(t,e){var n=t.split("."),r=n.pop(),i=n.reduce(function(t,e){return t[e]},this._data);i[r]=e},e.prototype.updateDom=function(t,e){var n=t.prop("tagName");switch(n){case"INPUT":this.updateDom_input(t,e);break;case"TEXTAREA":this.updateDom_normal(t,e);break;case"SELECT":this.updateDom_select(t,e);break;default:this.updateDom_normal(t,e)}},e.prototype.updateDom_input=function(t,e){var n=t.prop("type");switch(n){case"radio":this.updateDom_radio(t,e);break;case"checkbox":this.updateDom_check(t,e);break;default:this.updateDom_normal(t,e)}},e.prototype.updateDom_radio=function(e,n){e.each(function(e,r){var i=t.$(r);i.val()==n?i.prop("checked","checked"):i.prop("checked",!1)})},e.prototype.updateDom_check=function(e,n){e.each(function(e,r){var i=t.$(r);n.indexOf(i.val())>-1?i.prop("checked","checked"):i.prop("checked",!1)})},e.prototype.updateDom_normal=function(t,e){t.val(e)},e.prototype.updateDom_select=function(t,e){t.val(e)},e}();t.Inputs=e}(Pandyle||(Pandyle={})),function(t){var e=function(){function t(t){this._util=t,this._relations=[]}return t.CreateRelationCollection=function(e){return new t(e)},t.prototype.setRelation=function(t,e,n){var r=this;/^@.*/.test(t)?t=t.replace(/@(\w+)?/,function(t,n){return r._util.getAliasProperty(e,n)}):""!=n&&(t=n+"."+t),/^\./.test(t)&&(t=t.substr(1));var i=this._relations.filter(function(e){return e.property===t});0==i.length?this._relations.push({property:t,elements:[e]}):i[0].elements.indexOf(e)<0&&i[0].elements.push(e)},t.prototype.findSelf=function(t){return this._relations.filter(function(e){return e.property===t})},t.prototype.findSelfOrChild=function(t){var e=this;return this._relations.filter(function(n){return e._util.isSelfOrChild(t,n.property)})},t.prototype.removeChildren=function(t){for(var e=this._relations.length-1;e>=0;e--)this._util.isChild(t,this._relations[e].property)&&this._relations.splice(e,1)},t}();t.RelationCollection=e}(Pandyle||(Pandyle={})),function(t){var e=function(){function e(e,n,r){void 0===r&&(r=!0),this._data=t.$.extend({},n),this._root=e,this._methods={},this._variables={},this._defaultAlias={root:{data:this._data,property:""},window:{data:window,property:"@window"}},this._util=t.Util.CreateUtil(this),this._relationCollection=t.RelationCollection.CreateRelationCollection(this._util),this._renderer=new t.Renderer(this),r&&this.run()}return e.prototype.set=function(t,e){var n=this,r={};2===arguments.length?r[t]=e:r=t;var i=this.updateDataAndGetElementToRerender(r);i.forEach(function(t){n.render(t)})},e.prototype.get=function(e){var n=this;if(!e)return t.$.extend({},this._data);switch(t.$.type(e)){case"array":return e.map(function(t){return n.get(t)});case"string":return this._util.getValue(this._root,e,this._data);case"object":var r={};for(var i in e)r[i]=this._util.getValue(this._root,e[i],this._data);return r;default:return null}},e.prototype.append=function(e,n){var r=this;if("string"==typeof e){var i=this.getLastProperty(e),a=this.getTargetData(e),o=a[i];o.push(n);var c=this._relationCollection.findSelf(e);c.forEach(function(i){i.elements.forEach(function(i){var a=t.getDomData(i),o=t.iteratorBase.generateChild(a,i.children().length,n,e);if(a.binding.For){a.children.last().after(o);var c=[];c.push.call(a.children,o)}else i.append(o);r.render(t.$(o))})})}else e.each(function(e,i){var a=t.getDomData(t.$(i)),o=a.context;if(a.binding.For){var c=a.binding.For.pattern;o[c].push(n);var s=t.iteratorBase.generateChild(a,t.$(i).children().length,n,a.parentProperty+"."+c);a.children.last().after(s);var p=[];p.push.call(a.children,s),r.render(t.$(s))}else{c=a.binding.Each.pattern;o[c].push(n);s=t.iteratorBase.generateChild(a,t.$(i).children().length,n,a.parentProperty+"."+c);t.$(i).append(s),r.render(t.$(s))}})},e.prototype.appendArray=function(e,n){var r=this;if("string"==typeof e){var i=this.getLastProperty(e),a=this.getTargetData(e),o=a[i];n.forEach(function(t){o.push(t)});var c=this._relationCollection.findSelf(e);c.forEach(function(i){i.elements.forEach(function(i){var a=t.getDomData(i);n.forEach(function(n){var o=t.iteratorBase.generateChild(a,i.children().length,n,e);if(a.binding.For){a.children.last().after(o);var c=[];c.push.call(a.children,o)}else i.append(o);r.render(t.$(o))})})})}else e.each(function(e,i){var a=t.getDomData(t.$(i)),o=a.context;if(a.binding.For){var c=a.binding.For.pattern;n.forEach(function(e){o[c].push(e);var n=t.iteratorBase.generateChild(a,t.$(i).children().length,e,a.parentProperty+"."+c);a.children.last().after(n);var s=[];s.push.call(a.children,n),r.render(t.$(n))})}else{var s=a.binding.Each.pattern;n.forEach(function(e){o[s].push(e);var n=t.iteratorBase.generateChild(a,t.$(i).children().length,e,a.parentProperty+"."+s);t.$(i).append(n),r.render(t.$(n))})}})},e.prototype.run=function(){this.render(this._root,this._data,"",this._defaultAlias)},e.prototype.render=function(e,n,r,i){var a=this;e.each(function(e,o){a._renderer.renderSingle(o,n,r,t.$.extend({},i))})},e.prototype.getMethod=function(t){return this._methods[t]},e.prototype.transfer=function(t,e){return this._methods[t](e)},e.prototype.register=function(e,n){t.$.isFunction(n)?this._methods[e]=n:this._variables[e]=n},e.prototype.updateDataAndGetElementToRerender=function(e){var n=[];for(var r in e){var i=this.getLastProperty(r),a=this.getTargetData(r);a[i]=e[r];for(var o=this._relationCollection.findSelfOrChild(r),c=0;c<o.length;c++){var s=o[c],p=s.property;t.$.isArray(this.getDataByKey(p))&&this._relationCollection.removeChildren(p)}if(o=this._relationCollection.findSelfOrChild(r),o.length>0)for(c=0;c<o.length;c++){s=o[c];for(var u=0;u<s.elements.length;u++){var l=s.elements[u];t.getDomData(l).alias?n.indexOf(l)<0&&n.push(l):(s.elements.splice(u,1),u--)}}}return n},e.prototype.getTargetData=function(t){var e=t.split(/[\[\]\.]/).filter(function(t){return""!=t});e.pop();var n=this._data;return e.length>0&&(n=e.reduce(function(t,e){return t[e]},this._data)),n},e.prototype.getDataByKey=function(t){var e=t.split(/[\[\]\.]/).filter(function(t){return""!=t}),n=this._data;return e.length>0&&(n=e.reduce(function(t,e){return t?t[e]:null},this._data)),n},e.prototype.getLastProperty=function(t){var e=t.split(/[\[\]\.]/).filter(function(t){return""!=t}),n=e.pop();return n},e}();t.VM=e}(Pandyle||(Pandyle={})),function(t){var e=function(){function e(t){this.vm=t}return e.CreateUtil=function(t){var n=new e(t);return n},e.prototype.getValue=function(e,n,r){var i=this.calcuExpression(n,e,r),a=t.$.type(i);return"string"===a&&(i=unescape(i)),"string"===a||"number"===a||"boolean"===a||"null"===a||"undefined"===a?i:t.$.extend(this.toDefault(a),i)},e.prototype.calcuExpression=function(e,n,r){var i=this,a=/([^\+\-\*\/\?\:\>\=\<\!]|(\|\|)|(\&\&))+/g,o=/[\+\-\*\/\?\:\>\=\<\!]|(\|\|)|(\&\&)/g;if(o.test(e)){var c=e.replace(a,function(e){var a=i.calcu(e,n,r);return"string"===t.$.type(a)&&(a="'"+escape(a)+"'"),a});return new Function("return "+c)()}return this.calcu(e,n,r)},e.prototype.calcu=function(e,n,r){var i=this,a=this.dividePipe(e);if(e=a.property,["null","undefined","true","false"].indexOf(e)>-1)return new Function("return "+e)();if(e.match(/^('|"|\d).*$/))return new Function("return "+e)();var o=a.method,c=e.match(/[@\w]+((?:\(.*?\))*|(?:\[.*?\])*)/g);if(!c)return e;var s=c.reduce(function(e,a){var o,c=/^([@\w]+)([\(|\[].*)*/.exec(a),s=c[1];o=/^@.*/.test(s)?i.getAliasData(n,s.substr(1)):e[s];var p=c[2];if(p){var u=p.match(/\[\d+\]|\(.*\)/g);return u.reduce(function(e,a){if(/\[\d+\]/.test(a)){var o=parseInt(a.replace(/\[(\d+)\]/,"$1"));return e[o]}if(/\(.*\)/.test(a)){var c=a.replace(/\((.*)\)/,"$1").replace(/\s/,"").split(","),p=c.map(function(t){return/^[A-Za-z_\$\@].*$/.test(t)?i.calcu(t,n,r):(""===t&&(t='""'),new Function("return "+t)())}),u=e||i.vm.getMethod(s)||t.getMethod(s)||window[s];return u.apply(i,p)}},o)}return o},r);return o?this.transfer(o,s):s},e.prototype.convertFromPattern=function(e,n,r,i,a){var o=this,c=/{{\s*(.*?)\s*}}/g,s=!1,p=t.getDomData(e);c.test(r)&&(p.binding[n]||(p.binding[n]={pattern:r,related:!1}),s=p.binding[n].related);var u=r.replace(c,function(t,r){var c=o.dividePipe(r).property;return s||(o.vm._relationCollection.setRelation(c,e,a),p.binding[n].related=!0),o.getValue(e,r,i)});return u},e.prototype.toDefault=function(t){switch(t){case"string":return"";case"number":return 0;case"boolean":return!1;case"array":return[];case"object":return{};case"function":return function(){};default:return null}},e.prototype.setAlias=function(e,n,r){var i=t.getDomData(e),a=r||i.context;if(i.alias.self={data:a,property:n},e.attr("p-as")){var o=e.attr("p-as");i.alias[o]={data:a,property:n}}},e.prototype.getAliasData=function(e,n){var r=t.getDomData(e);return r.alias[n].data},e.prototype.getAliasProperty=function(e,n){var r=t.getDomData(e);return r.alias[n].property},e.prototype.dividePipe=function(t){var e=t.split("|"),n=e[0].replace(/\s/g,""),r=e[1]?e[1].replace(/\s/g,""):null;return{property:n,method:r}},e.prototype.convert=function(t,e){if(/^{.*}$/.test(t)){var n=t.replace(/{|}/g,"").split(",");return n.reduce(function(t,n){var r=n.split(":");return/^[a-zA-z$_]+/.test(r[1])?t[r[0]]=r[1].split(".").reduce(function(t,e){return t[e]},e):t[r[0]]=new Function("return "+r[1])(),t},{})}return this.vm._methods[t](e)},e.prototype.isSelfOrChild=function(t,e){t=t.replace(/[\[\]\(\)\.]/g,function(t){return"\\"+t});var n=new RegExp("^"+t+"$|^"+t+"[\\[\\.]\\w+");return n.test(e)},e.prototype.isChild=function(t,e){var n="^"+t.replace(/[\[\]\.]/g,function(t){return"\\"+t})+"[\\[\\.]\\w+",r=new RegExp(n);return r.test(e)},e.prototype.transfer=function(t,e){return this.vm.transfer(t,e)},e.prototype.setRelation=function(t,e,n){this.vm._relationCollection.setRelation(t,e,n)},e}();t.Util=e}(Pandyle||(Pandyle={})),function(t){var e=function(){function t(){}return t.prototype.next=function(){this._next&&(this._next.init(this._context,this._util),this._next.execute())},t.prototype.deep=function(){},t.prototype.error=function(t,e,n){console.error("在执行"+t+"指令时发生错误。错误信息："+e),console.log("当前元素为："),console.log(this._context.element),console.log("当前元素的数据上下文："),console.log(n)},t.prototype.append=function(t){this._next=t},t.prototype.init=function(t,e){this._context=t,this._util=e},t}();t.DirectiveBase=e}(Pandyle||(Pandyle={})),function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(){var e=t.$(this._context.element),n=t.getDomData(e);try{if(e.attr("p-bind")){var r=t.$(e).attr("p-bind").split("^");r.forEach(function(t,e){var r=t.match(/^\s*([\w-\?]+)\s*:\s*(.*)$/),i=r[1],a=r[2].replace(/\s*$/,"");n.binding[i]={pattern:a,related:!1}}),e.removeAttr("p-bind")}var i=n.binding,a=n.context;for(var o in i)if(["text","If","Each","For","Context"].indexOf(o)<0){var c=this._util.convertFromPattern(t.$(e),o,i[o].pattern,a,this._context.parentProperty);if(o.endsWith("?")){var s=o.replace(/\?$/,"");"true"==c?t.$(e).attr(s,s):t.$(e).removeAttr(s)}else t.$(e).attr(o,c)}this.next()}catch(t){this.error("p-bind",t.message,n)}},n}(t.DirectiveBase);t.PBindDirective=e}(Pandyle||(Pandyle={})),function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(){var e=t.$(this._context.element),n=t.getDomData(e);try{e.attr("p-com")&&t.loadComponent(this._context.element,this._util.vm),this.next()}catch(t){this.error("p-com",t.message,n)}},n}(t.DirectiveBase);t.pComDirective=e}(Pandyle||(Pandyle={})),function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(){var e=t.$(this._context.element),n=t.getDomData(e);try{if(0===e.children().length){var r=n.context,i=e.text();n.binding.text&&(i=n.binding.text.pattern);var a=this._util.convertFromPattern(e,"text",i,r,this._context.parentProperty);e.html(a)}}catch(t){this.error("文本插值",t.message,n)}},n}(t.DirectiveBase);t.pTextDirective=e}(Pandyle||(Pandyle={})),function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(){var e=t.$(this._context.element),n=this._context.parentProperty,r=t.getDomData(e);try{if(e.attr("p-if")&&(r.binding.If={pattern:e.attr("p-if"),related:!1},e.removeAttr("p-if")),r.binding.If){var i=e.parent();r.parent||(r.parent=i);var a=r.binding.If.pattern,o=r.context,c=this._util.convertFromPattern(e,"If",a,o,n),s=new Function("return "+c);if(s()){if(0===e.parent().length){var p=r.pIndex,u=r.parent.children().filter(function(e,n){return t.getDomData(t.$(n)).pIndex===p-1});u.length>0?e.insertAfter(u):r.parent.prepend(e)}this.next()}else e.detach()}else this.next()}catch(t){this.error("p-if",t.message,r)}},n}(t.DirectiveBase);t.PIfDirective=e}(Pandyle||(Pandyle={})),function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(){var e=t.$(this._context.element),n=t.getDomData(e);try{var r=n.context,i=this._context.parentProperty;if(e.attr(this._directiveName)&&(n.binding[this._directiveBinding]={pattern:e.attr(this._directiveName),related:!1},e.removeAttr(this._directiveName)),n.binding[this._directiveBinding]){if("p-for"===this._directiveName){var a=e.parent();n.parent||(n.parent=a)}var o=n.binding[this._directiveBinding].pattern.replace(/\s/g,""),c=this._util.dividePipe(o).property,s=this._util.calcu(o,e,r);if(!n.pattern){if("p-for"===this._directiveName){var p=e.prop("outerHTML");p=p.replace(/jQuery\d*\="\d*"/,""),n.pattern=p}else n.pattern=e.html();this._util.setRelation(c,e,i)}var u=c;""!==i&&(u=i+"."+c),this.addChildren(e,s,u)}this.next()}catch(t){this.error(this._directiveName,t.message,n)}},n.generateChild=function(e,n,r,i){var a=e.alias,o=e.pattern,c=t.$(o),s=t.$.extend({},a,{index:{data:n,property:"@index"}}),p=t.getDomData(c);return p.context=r,p.parentProperty=i.concat("[",n.toString(),"]"),p.alias=s,c[0]},n}(t.DirectiveBase);t.iteratorBase=e}(Pandyle||(Pandyle={})),function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._directiveName="p-each",t._directiveBinding="Each",t}return __extends(n,e),n.prototype.addChildren=function(e,n,r){var i=t.getDomData(e);e.children().remove(),i.children&&i.children.remove();var a=[];n.forEach(function(e,n){var o=t.iteratorBase.generateChild(i,n,e,r);a.push(o)}),a.length>0&&e.append(a),i.children=e.children()},n}(t.iteratorBase);t.PEachDirective=e}(Pandyle||(Pandyle={})),function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._directiveBinding="For",t._directiveName="p-for",t}return __extends(n,e),n.prototype.addChildren=function(e,n,r){var i=t.getDomData(e);e.children().remove(),i.children&&i.children.remove();var a=t.$("<div />"),o=[];n.forEach(function(e,n){var a=t.iteratorBase.generateChild(i,n,e,r);o.push(a)}),a.append(o);var c=a.children();i.children=c,e.detach();var s=i.pIndex,p=i.parent.children().filter(function(e,n){return t.getDomData(t.$(n)).pIndex===s-1});p.length>0?c.insertAfter(p):i.parent.prepend(c)},n}(t.iteratorBase);t.PForDirective=e}(Pandyle||(Pandyle={})),function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(){var e=t.$(this._context.element),n=this._context.parentProperty,r=t.getDomData(e),i=r.binding;try{if(e.attr("p-context")&&(i.Context={pattern:e.attr("p-context"),related:!1},e.removeAttr("p-context")),i.Context){var a=void 0,o=i.Context.pattern,c=this._util.dividePipe(o),s=c.property,p=c.method,u=s;""!==n&&(u=n+"."+s),a=r.ocontext?r.ocontext:r.context;var l=this._util.calcu(s,e,a);p&&(l=this._util.convert(p,t.$.extend({},l))),r.ocontext||(this._util.setAlias(e,u,l),this._util.setRelation(s,t.$(e),n),r.ocontext=a),r.context=l,r.oparentProperty=u,e.find("*").each(function(e,n){t.getDomData(t.$(n)).context=null}),this._context.parentProperty=u}this.next()}catch(t){this.error("p-context",t.message,r)}},n}(t.DirectiveBase);t.PContextDirective=e}(Pandyle||(Pandyle={})),function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(){var e=this,n=t.$(this._context.element),r=t.getDomData(n);try{if(n.attr("p-on")){var i=t.$(n).attr("p-on").split("^");i.forEach(function(t,i){var a=t.match(/^\s*([\w-]+)\s*:\s*(.*)$/),o=a[1],c=a[2].replace(/\s*$/,"");n.on(o,function(){e._util.calcu(c,n,r.context)})}),n.removeAttr("p-on")}this.next()}catch(t){this.error("p-on",t.message,r)}},n}(t.DirectiveBase);t.POnDirective=e}(Pandyle||(Pandyle={})),function(t){var e=function(){function e(t){this._util=t}return e.prototype.add=function(t){return this._firstDirective?(this._lastDirective.append(t),this._lastDirective=t):this._firstDirective=this._lastDirective=t,this},e.prototype.start=function(t){this._firstDirective.init(t,this._util),this._firstDirective.execute()},e.createPipeLine=function(n){var r=new e(n);return r.add(new t.PContextDirective).add(new t.PIfDirective).add(new t.PForDirective).add(new t.PEachDirective).add(new t.PBindDirective).add(new t.POnDirective).add(new t.pComDirective).add(new t.pTextDirective),r},e}();t.PipeLine=e}(Pandyle||(Pandyle={})),Array.prototype.filter||(Array.prototype.filter=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var n=new Array,r=arguments[1],i=0;i<e;i++)if(i in this){var a=this[i];t.call(r,a,i,this)&&n.push(a)}return n}),Array.prototype.forEach||(Array.prototype.forEach=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var n=arguments[1],r=0;r<e;r++)r in this&&t.call(n,this[r],r,this)}),Array.prototype.map||(Array.prototype.map=function(t,e){var n=this.length;if("function"!=typeof t)throw new TypeError;for(var r=new Array(n),i=(e=arguments[1],0);i<n;i++)i in this&&(r[i]=t.call(e,this[i],i,this));return r}),Array.prototype.reduce||(Array.prototype.reduce=function(t,e){"use strict";if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var n,r,i=this.length>>>0,a=!1;for(1<arguments.length&&(r=e,a=!0),n=0;i>n;++n)this.hasOwnProperty(n)&&(a?r=t(r,this[n],n,this):(r=this[n],a=!0));if(!a)throw new TypeError("Reduce of empty array with no initial value");return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var e=0,n=this.length;e<n;e++)if(this[e]===t)return e;return-1}),function(t){var e=function(){function e(e){this._util=t.Util.CreateUtil(e),this._pipeline=t.PipeLine.createPipeLine(this._util)}return e.prototype.renderSingle=function(e,n,r,i){var a=t.$(e),o=t.getDomData(a);if(o.context||(o.context=n),o.binding||(o.binding={}),o.parentProperty||(o.parentProperty=r),i&&!t.$.isEmptyObject(i))if(o.alias){var c=o.alias.index;o.alias=t.$.extend(o.alias,i),c&&(o.alias.index=c)}else o.alias=i;n=o.context,r=o.parentProperty,this._util.setAlias(a,r,n),this.renderPipe(e,r),n=o.context,o.oparentProperty&&(r=o.oparentProperty),this.renderChild(e,n,r),o.afterRender&&o.afterRender()},e.prototype.renderChild=function(e,n,r){var i=this,a=t.$(e),o=t.getDomData(a);o.children||(o.children=a.children());var c=o.children;if(c.length>0){var s=o.alias;c.each(function(e,a){var o=t.$(a),c=t.getDomData(o);c.context||(c.context=n),c.pIndex=e,i.renderSingle(o[0],n,r,t.$.extend({},s))})}},e.prototype.renderPipe=function(t,e){var n={element:t,parentProperty:e};this._pipeline.start(n)},e}();t.Renderer=e}(Pandyle||(Pandyle={}));